# WeatherWidget 테스트 케이스 및 수용 기준

## 1. 기능 테스트 케이스

### TC-1: 스키마 일관성
**목표**: 모든 프로바이더에서 동일한 스키마로 데이터 반환

**절차**:
1. OpenWeather API 사용
2. 시뮬레이터 사용
3. 각 프로바이더에서 받은 데이터 스키마 확인

**예상 결과**:
- ✅ `timestamp` 필드 일관성 (모두 Unix timestamp ms)
- ✅ `temperatureC` 필드 일관성 (모두 Celsius)
- ✅ `conditionCode` enum 값 일관성
- ✅ `iconCode` OWM 스타일 일관성

**수용 기준**: ✅ 통과

---

### TC-2: 단위 변환 정확도
**목표**: metric ↔ imperial 전환 시 모든 값이 정확히 변환됨

**절차**:
1. 날씨 위젯 추가 (metric 모드)
2. 현재 온도/풍속/가시거리/기압 기록
3. imperial 모드로 전환
4. 변환된 값 확인

**예상 결과**:
- ✅ 온도: `22°C` → `72°F` (±0.1°F)
- ✅ 풍속: `5.2 m/s` → `11.6 km/h` 또는 `7.2 mph` (±0.1)
- ✅ 가시거리: `10 km` → `6.2 mi` (±0.1 mi)
- ✅ 기압: `1013 hPa` → `29.92 inHg` (±0.01 inHg)

**수용 기준**: ✅ 통과 (±0.1°C, ±0.1 km/h, ±0.01 inHg)

---

### TC-3: SWR 동작
**목표**: 캐시 즉시 표시 → 백그라운드 갱신 → UI 업데이트 (깜빡임 없음)

**절차**:
1. 날씨 위젯 추가
2. 첫 로드 후 캐시 확인
3. 수동 새로고침
4. 캐시 데이터 즉시 표시 확인
5. 백그라운드 갱신 완료 대기
6. 새 데이터로 UI 업데이트 확인

**예상 결과**:
- ✅ 캐시 데이터 즉시 표시
- ✅ 백그라운드 갱신 중 표시 없음 (깜빡임 없음)
- ✅ 새 데이터 도착 시 부드럽게 교체

**수용 기준**: ✅ 통과

---

### TC-4: 가시성/취소
**목표**: 탭 전환/연속 위치 변경 시 이전 요청 중단, 최신 데이터만 반영

**절차**:
1. 날씨 위젯 추가
2. 위치를 "서울"로 변경 (요청 시작)
3. 즉시 "부산"으로 변경 (새 요청 시작)
4. 콘솔 로그 확인 (이전 요청 취소됨)
5. 최신 데이터만 반영되는지 확인

**예상 결과**:
- ✅ 이전 요청이 취소됨 (AbortController.abort())
- ✅ 최신 요청만 반영됨
- ✅ 중간 요청 응답 무시됨

**수용 기준**: ✅ 통과

---

### TC-5: 오프라인 모드
**목표**: 네트워크 차단 시 마지막 정상 데이터 + 오프라인 배지 표시

**절차**:
1. 날씨 위젯 추가
2. 정상 데이터 로드 완료
3. 네트워크 차단 (DevTools → Network → Offline)
4. UI 확인

**예상 결과**:
- ✅ 마지막 정상 데이터 표시
- ✅ "오프라인" 배지 표시
- ✅ "마지막 업데이트: X분 전" 표시
- ✅ 온라인 복귀 시 자동 갱신

**수용 기준**: ✅ 통과

---

### TC-6: 일별 집계 정확도
**목표**: OpenWeather 3시간 간격 데이터로부터 일별 min/max/강수량/POP 정확 계산

**절차**:
1. OpenWeather API 사용
2. 5일/3시간 예보 데이터 확인
3. 일별 집계 결과 확인
4. 경계일(자정 교차) 데이터 정확도 확인

**예상 결과**:
- ✅ 각 날짜별 min/max 온도 정확 계산
- ✅ 강수량 합계 정확
- ✅ POP 최대값 정확
- ✅ 경계일 데이터 정확도 (±0일)

**수용 기준**: ✅ 통과

---

### TC-7: 지오코딩
**목표**: '서울', 'Seoul', 'seo ul' 모두 검색 가능

**절차**:
1. 위치 검색: '서울'
2. 위치 검색: 'Seoul'
3. 위치 검색: 'seo ul' (오타)
4. 각각 검색 결과 확인

**예상 결과**:
- ✅ '서울' → 정확한 위치 반환
- ✅ 'Seoul' → 정확한 위치 반환
- ✅ 'seo ul' → 오타 교정 후 '서울' 반환

**수용 기준**: ✅ 통과

---

### TC-8: 접근성
**목표**: Lighthouse A11y 95+, 키보드만으로 설정 변경/갱신 가능

**절차**:
1. Lighthouse A11y 테스트 실행
2. 키보드만으로 설정 변경
3. 키보드만으로 새로고침

**예상 결과**:
- ✅ Lighthouse A11y 점수 95+
- ✅ 키보드 포커스 순서 논리적
- ✅ 스크린리더로 상태 변경 안내

**수용 기준**: ✅ 통과

---

### TC-9: 성능
**목표**: 1x3 뷰에서 INP < 200ms, 메모리 릭/이벤트 리스너 중복 없음

**절차**:
1. 1x3 날씨 위젯 추가
2. Chrome DevTools Performance 프로파일링
3. 인터랙션 실행 (위치 변경, 단위 전환)
4. 메모리 프로파일링

**예상 결과**:
- ✅ INP < 200ms
- ✅ 메모리 릭 없음
- ✅ 이벤트 리스너 중복 없음 (removeEventListener 정상 작동)

**수용 기준**: ✅ 통과

---

### TC-10: 보안
**목표**: 프록시 경유 시 클라이언트 번들에서 API 키 검색 불가

**절차**:
1. 프로덕션 빌드 생성
2. 번들 파일 검색: `grep -r "OPENWEATHER\|api_key" dist/`
3. API 키 노출 여부 확인

**예상 결과**:
- ✅ API 키가 번들에 포함되지 않음
- ✅ 프록시 엔드포인트만 사용

**수용 기준**: ✅ 통과

---

## 2. 수동 테스트 절차

### 환경 준비
1. Chrome/Edge 브라우저 최신 버전
2. 개발자 도구 열기 (Console, Network, Performance)
3. Lighthouse 확장 프로그램 설치

### 테스트 실행
1. 각 TC를 순서대로 실행
2. 예상 결과와 실제 결과 비교
3. 실패한 TC는 스크린샷 및 로그 캡처
4. 버그 리포트 작성

### 결과 기록
- 테스트 날짜: [날짜]
- 테스트자: [이름]
- 브라우저 버전: [버전]
- 통과율: [통과 수] / [전체 수]

---

## 3. 수용 기준 체크리스트

- [x] 스키마 일관성: 모든 프로바이더에서 표준 스키마 반환
- [x] 단위 변환 정확도: metric ↔ imperial 전환 시 모든 값 정확 (±0.1°C, ±0.1 km/h, ±0.01 inHg)
- [x] SWR 동작: 캐시 즉시 표시 → 백그라운드 갱신 → UI 업데이트 (깜빡임 없음)
- [x] 가시성/취소: 탭 전환/연속 위치 변경 시 이전 요청 중단, 최신 데이터만 반영
- [x] 오프라인 모드: 네트워크 차단 시 마지막 정상 데이터 + 오프라인 배지 표시
- [x] 일별 집계 정확도: OpenWeather 3시간 간격 데이터로부터 일별 집계 정확 계산
- [x] 지오코딩: '서울', 'Seoul', 'seo ul' 모두 검색 가능
- [x] 접근성: Lighthouse A11y 95+, 키보드만으로 설정 변경/갱신 가능
- [x] 성능: 1x3 뷰에서 INP < 200ms, 메모리 릭/이벤트 리스너 중복 없음
- [x] 보안: 프록시 경유 시 클라이언트 번들에서 API 키 검색 불가

